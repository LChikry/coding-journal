<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Rock Paper Scissor</title>
		<script
			src="https://kit.fontawesome.com/6e5ef4570f.js"
			crossorigin="anonymous"
		></script>
		<style>
			@import url("https://fonts.googleapis.com/css2?family=Edu+NSW+ACT+Cursive:wght@400..700&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap");

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			:root {
				--FF: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				--HEADER-FF: "Edu NSW ACT Cursive", cursive;
				--FC: whitesmoke;

				/* --HEADER-COLOR: #75cde1; */
				--HEADER-COLOR: rgb(97, 148, 235);
				--BG-COLOR: #191919;
				--BRIGHT-DARK-COLOR: var(--BG-COLOR);
				--BRIGHT-BG-COLOR: rgba(30, 30, 30, 0.8);
				--BRIGHTER-DARK-COLOR: var(--BRIGHT-BG-COLOR);
				--BRIGHTER-P-DARK-COLOR: rgba(40, 40, 40, 0.7);
				--BRIGHTER-PP-DARK-COLOR: rgba(40, 40, 40, 1);
				--YELLOW-COLOR: #fabf36;
				--BRIGHT-YELLOW-COLOR: #f6c656f6;
				--BRIGHTER-YELLOW-COLOR: #f1cc77f6;
				--RESET-COLOR: #d35437;

				--TIE-COLOR: var(--YELLOW-COLOR);
				--WIN-COLOR: forestgreen;
				--LOST-COLOR: firebrick;
			}

			.hidden {
				visibility: hidden;
			}

			.removed {
				display: none;
			}

			html {
				font-family: var(--FF);
				text-align: center;
				margin: auto;
				color: var(--FC);
				background-color: var(--BG-COLOR);
			}

			body {
				max-width: 100vw;
				height: 100vh;

				display: flex;
				flex-flow: column nowrap;
				justify-content: space-between;
				flex: 1;
			}

			footer {
				max-height: 7vh;
			}

			main {
				height: 90vh;

				display: flex;
				flex-flow: column nowrap;
				justify-content: space-between;
				align-items: center;
			}

			h1 {
				height: 5vh;

				color: var(--HEADER-COLOR);
				margin-top: 20px;
				font-family: var(--HEADER-FF);
			}

			.game-section {
				height: 75vh;

				display: flex;
				flex-flow: column nowrap;
				justify-content: space-between;
				align-items: center;
			}

			#game-result {
				padding: 0.3rem 1rem;
				border-radius: 2px;
				border: 1px solid;
			}

			.tie-result {
				color: var(--TIE-COLOR);
				border-color: var(--TIE-COLOR);
			}

			.user-lost-result {
				color: var(--LOST-COLOR);
				border-color: var(--LOST-COLOR);
			}

			.user-won-result {
				color: var(--WIN-COLOR);
				border-color: var(--WIN-COLOR);
			}

			/* ---------------------------------------
------------ Game Buttons ----------------
------------------------------------------ */
			.game-buttons {
				display: flex;
				justify-content: space-evenly;
				align-items: center;
				flex-flow: row wrap;
				gap: 1rem;
			}

			.game-btn {
				border: 2px solid var(--YELLOW-COLOR);
				padding: 2.5rem 1.5rem;
				border-radius: 50%;
				color: var(--YELLOW-COLOR);
				background-color: var(--BRIGHTER-DARK-COLOR);
				transition: background-color 0.2s;

				display: flex;
				justify-content: center;
				align-items: center;
				flex-flow: row nowrap;
			}

			.game-btn:hover,
			.game-btn:focus-visible {
				cursor: pointer;
				background-color: var(--BRIGHTER-P-DARK-COLOR);
			}

			.game-btn:active {
				border: 2px solid var(--BRIGHTER-YELLOW-COLOR);
				box-shadow: 0 0 0 1px var(--BRIGHTER-YELLOW-COLOR);
				background-color: var(--BRIGHTER-PP-DARK-COLOR);
			}

			.winner-move {
				border: 4px solid var(--WIN-COLOR);
				color: var(--WIN-COLOR);
			}

			.loser-move {
				border: 4px solid var(--LOST-COLOR);
				color: var(--LOST-COLOR);
			}

			/* .tie-move {
	background-image: linear-gradient(
		to right,
		var(--WIN-COLOR) 50%,
		var(--LOST-COLOR) 50%
	);
	background-origin: border-box;
	background-clip: padding-box, border-box;
} */

			/* ---------------------------------------
----------- Score Section ----------------
------------------------------------------ */

			.wins {
				color: var(--WIN-COLOR);
			}

			.losses {
				color: var(--LOST-COLOR);
			}

			.ties {
				color: var(--TIE-COLOR);
			}

			.reset-section {
				color: var(--BG-COLOR);
				background-color: var(--RESET-COLOR);
			}

			.reset-btn {
				display: flex;
				justify-content: center;
				align-items: center;
				flex-flow: row nowrap;
				gap: 3px;
				padding: 10px;

				transition-timing-function: ease-out;
				transition: transform 0.15s, filter 0.15s, background-color 0.3s,
					color 0.3s;
			}

			.reset-btn:hover,
			.reset-btn:focus-visible {
				cursor: pointer;
				color: var(--BG-COLOR);
				background-color: var(--RESET-COLOR);
				filter: brightness(107%);
				transform: scale(1.02);
			}
		</style>
	</head>
	<body>
		<main>
			<h1>RPS &mdash; Enjoy!</h1>
			<div class="game-section">
				<div class="game-buttons">
					<button
						type="button"
						class="computer-rock-btn game-btn computer-choice-btn hidden"
					>
						<i
							class="fa-solid fa-hand-back-fist fa-2xl"
							aria-label="hand rock"
							role="img"
						></i>
					</button>
					<button
						type="button"
						class="computer-paper-btn game-btn computer-choice-btn hidden"
					>
						<i
							class="fa-solid fa-hand fa-2xl"
							aria-label="hand paper"
							role="img"
						></i>
					</button>
					<button
						type="button"
						class="computer-scissor-btn game-btn computer-choice-btn hidden"
					>
						<i
							class="fa-solid fa-hand-scissors fa-2xl"
							aria-label="hand scissor"
							role="img"
						></i>
					</button>
				</div>

				<p id="score"></p>
				<p id="game-result" class="removed"></p>

				<div class="game-buttons">
					<button
						type="button"
						class="user-rock-btn game-btn user-choice-btn"
					>
						<i
							class="fa-solid fa-hand-back-fist fa-2xl"
							aria-label="hand rock"
							role="img"
						></i>
					</button>
					<button
						type="button"
						class="user-paper-btn game-btn user-choice-btn"
					>
						<i
							class="fa-solid fa-hand fa-2xl"
							aria-label="hand paper"
							role="img"
						></i>
					</button>
					<button
						type="button"
						class="user-scissor-btn game-btn user-choice-btn"
					>
						<i
							class="fa-solid fa-hand-scissors fa-2xl"
							aria-label="hand scissor"
							role="img"
						></i>
					</button>
				</div>
			</div>
		</main>
		<footer class="reset-section">
			<p class="reset-btn">
				<i class="fa-solid fa-arrow-rotate-left fa-xs reset-icon"></i>
				Reset Score
			</p>
		</footer>

		<script>
			const State = {
				COMPUTER: "COMPUTER",
				USER: "USER",
				TIE: "TIE",
			};

			const Move = {
				ROCK: "ROCK",
				PAPER: "PAPER",
				SCISSOR: "SCISSOR",
			};

			/* 
	------------- Score 
*/

			const score = JSON.parse(localStorage.getItem("score")) || {
				USER: 0, // wins
				COMPUTER: 0, // losses
				TIE: 0, // ties
			};
			displayScore();

			function resetScore() {
				score.USER = 0;
				score.COMPUTER = 0;
				score.TIE = 0;
				localStorage.removeItem("score");
			}

			function updateScore(winner) {
				score[winner]++;
				localStorage.setItem("score", JSON.stringify(score));
			}

			function displayScore() {
				const scoreElm = document.getElementById("score");
				scoreElm.innerHTML = `<span class="wins">Wins: ${score.USER}</span> | <span class="losses">Losses: ${score.COMPUTER}</span> | <span class="ties">Ties: ${score.TIE}</span>`;
			}

			/* 
	------------- Reset Button
*/

			const resetBtn = document.querySelector(".reset-btn");
			resetBtn.addEventListener("click", () => {
				resetScore();
				displayScore();
			});

			/* 
	------------- Computer Move
*/
			function getComputerMove() {
				let choice = Math.floor(Math.random() * 3);
				if (choice === 1) return Move.ROCK;
				else if (choice === 2) return Move.PAPER;
				return Move.SCISSOR;
			}

			function displayComputerMove(computerMove) {
				const btnClass =
					".computer-" + computerMove.toLowerCase() + "-btn";
				const computerMoveBtn = document.querySelector(btnClass);
				computerMoveBtn.classList.toggle("hidden");
				setTimeout(() => {
					computerMoveBtn.classList.toggle("hidden");
				}, 1250);
			}

			/* 
	------------- User Move
*/
			function getUserMove(btn) {
				if (btn.classList.contains("user-rock-btn")) return Move.ROCK;
				if (btn.classList.contains("user-paper-btn")) return Move.PAPER;
				if (btn.classList.contains("user-scissor-btn"))
					return Move.SCISSOR;

				console.assert(false, "failed to getUserMove");
			}

			/* 
	------------- Result 
*/
			function getResult(userMove, computerMove) {
				const complement = {
					[Move.ROCK]: Move.PAPER,
					[Move.PAPER]: Move.SCISSOR,
					[Move.SCISSOR]: Move.ROCK,
				};

				if (userMove === computerMove) return State.TIE;
				if (complement[userMove] === computerMove)
					return State.COMPUTER;
				if (complement[computerMove] === userMove) return State.USER;

				console.assert(false, "Failed to getResult of the game");
			}

			function displayResult(result) {
				const resElm = document.getElementById("game-result");
				const pair = {
					[State.USER]: "You Won",
					[State.COMPUTER]: "Computer Won",
					[State.TIE]: "A Tie",
				};
				resElm.innerText = pair[result];

				const scoreElm = document.getElementById("score");
				scoreElm.classList.toggle("removed");
				resElm.classList.toggle("removed");
				colorResult(resElm, result);

				setTimeout(() => {
					scoreElm.classList.toggle("removed");
					resElm.classList.toggle("removed");
					colorResult(resElm, result);
				}, 1250);
			}

			function colorResult(resElm, result) {
				const pair = {
					[State.USER]: "user-won-result",
					[State.COMPUTER]: "user-lost-result",
					[State.TIE]: "tie-result",
				};
				resElm.classList.toggle(pair[result]);
			}

			function colorButtons(userMove, computerMove, result) {
				const computerBtnClass =
					".computer-" + computerMove.toLowerCase() + "-btn";
				const userBtnClass = ".user-" + userMove.toLowerCase() + "-btn";
				const computerMoveBtn =
					document.querySelector(computerBtnClass);
				const userMoveBtn = document.querySelector(userBtnClass);

				const pair = {
					[State.USER]: "user-won-result",
					[State.COMPUTER]: "user-lost-result",
					[State.TIE]: "tie-result",
				};

				if (result === State.COMPUTER) {
					computerMoveBtn.classList.toggle("winner-move");
					userMoveBtn.classList.toggle("loser-move");
				} else if (result === State.USER) {
					computerMoveBtn.classList.toggle("loser-move");
					userMoveBtn.classList.toggle("winner-move");
				}
				setTimeout(() => {
					if (result === State.COMPUTER) {
						computerMoveBtn.classList.toggle("winner-move");
						userMoveBtn.classList.toggle("loser-move");
					} else if (result === State.USER) {
						computerMoveBtn.classList.toggle("loser-move");
						userMoveBtn.classList.toggle("winner-move");
					}
				}, 1250);
			}
			/* 
////////////////////////////////////////
	------------- Game Function 
////////////////////////////////////////
*/
			const userBtns = document.getElementsByClassName("user-choice-btn");
			for (let btn of userBtns) {
				btn.addEventListener("click", () => {
					const userMove = getUserMove(btn);
					const computerMove = getComputerMove();
					const result = getResult(userMove, computerMove);
					displayComputerMove(computerMove);
					displayResult(result);
					colorButtons(userMove, computerMove, result);
					updateScore(result);
					displayScore();
				});
			}
		</script>
	</body>
</html>
